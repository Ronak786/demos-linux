- add timeouts when a client does not do anything.
- do the writing correctly.
